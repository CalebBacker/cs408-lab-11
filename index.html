<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Item Manager</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/style.css" />

</head>

<body>

<h1>Super Simple Inventory Management Browser Application</h1>
<h2>S.S.I.M.B.A</h2>

<div id ="load-section">
    <button id="load-btn" onclick="loadItems()">Load All Items</button>
</div>


<!--  Item add form -->
<div id="item-form">
    <h3>Add Item</h3>
    <input type="text" id="item-id" placeholder="Item ID" required>
    <input type="text" id="item-name" placeholder="Item Name" required>
    <input type="number" id="item-price" placeholder="Price" required>
    <button onclick="addItem()">Add Item</button>
</div>

<!-- item table -->
<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Price</th>
        <th>Delete</th>
    </tr>
    </thead>
    <tbody id="table-body">
    <!-- Rows inserted dynamically -->
    </tbody>
</table>

<script>
    const API_URL = "https://0edqok25n7.execute-api.us-east-2.amazonaws.com/items";

    // Load all items on page load(GET)
    window.onload = loadItems;

    function loadItems() {
        fetch(API_URL, { method: "GET" })
            .then(res => res.json())
            .then(data => {
                let table = document.getElementById("table-body");
                table.innerHTML = ""; // Clear existing rows

                data.forEach(item => {
                    let row = `
                            <tr>
                                <td>${item.id}</td>
                                <td>${item.name}</td>
                                <td>$${item.price}</td>
                                <td><button class="delete-btn" onclick="deleteItem('${item.id}')">Delete</button></td>
                            </tr>
                        `;
                    table.innerHTML += row;
                });
            })
            .catch(err => console.error(err));
    }

    //  Add a new item to inventory(PUT)
    function addItem() {
        let id = document.getElementById("item-id").value;
        let name = document.getElementById("item-name").value;
        let price = document.getElementById("item-price").value;

        fetch(API_URL, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ id, name, price })
        })
            .then(() => loadItems());
    }

    //  Delete item by ID (DELETE)
    function deleteItem(id) {
        fetch(`${API_URL}/${id}`, {
            method: "DELETE"
        })
            .then(() => loadItems());
    }
</script>
</body>
</html>
